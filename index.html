<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>TrachTrainer - Trachtenberg Speed Multiplication Practice</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Header -->
  <header class="app-header">
    <div class="container">
      <h1 class="app-title">TrachTrainer</h1>
      <div class="header-actions">
        <button class="btn btn-outline btn-sm" id="theme-toggle">
          <span id="theme-icon">üåô</span>
        </button>
        <button class="btn btn-outline btn-sm" id="numpad-toggle-btn">Numpad</button>
        <button class="btn btn-outline btn-sm" id="rules-toggle">Rules</button>
        <button class="btn btn-outline btn-sm" id="history-btn">History</button>
        <button class="btn btn-outline btn-sm" id="progress-btn">Progress</button>
        <button class="btn btn-outline btn-sm" id="about-btn">About</button>
      </div>
    </div>
  </header>

  <!-- Rules Side Panel -->
  <aside id="rules-panel" class="rules-panel">
    <div class="rules-panel-header">
      <h2 class="rules-panel-title">Trachtenberg Rules</h2>
      <button class="btn btn-outline btn-sm" id="close-rules">Close</button>
    </div>
    <div class="rules-panel-content">
      <!-- Rules will be populated dynamically by JavaScript -->
    </div>
  </aside>

  <!-- Numpad Panel -->
  <aside id="numpad-panel" class="numpad-panel">
    <div class="numpad-header">
      <h3 class="numpad-title">Numpad</h3>
      <button class="btn btn-outline btn-sm" id="toggle-numpad">
        <span id="numpad-toggle-icon">‚óÄ</span>
      </button>
    </div>
    <div class="numpad-content">
      <div class="numpad-direction-toggle">
        <button class="btn btn-sm" id="direction-toggle">
          <span id="direction-icon">‚Üê</span>
          <span id="direction-text">R‚ÜíL</span>
        </button>
      </div>
      <div class="numpad-grid">
        <button class="numpad-btn" data-value="7">7</button>
        <button class="numpad-btn" data-value="8">8</button>
        <button class="numpad-btn" data-value="9">9</button>
        <button class="numpad-btn" data-value="4">4</button>
        <button class="numpad-btn" data-value="5">5</button>
        <button class="numpad-btn" data-value="6">6</button>
        <button class="numpad-btn" data-value="1">1</button>
        <button class="numpad-btn" data-value="2">2</button>
        <button class="numpad-btn" data-value="3">3</button>
        <button class="numpad-btn numpad-btn-clear" data-action="clear">C</button>
        <button class="numpad-btn" data-value="0">0</button>
        <button class="numpad-btn numpad-btn-backspace" data-action="backspace">‚å´</button>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="app-main">
    <div class="container">

      <!-- Session Setup Screen -->
      <section id="setup-screen" class="screen active">
        <div class="setup-layout">
          <!-- Left Sidebar -->
          <aside class="setup-sidebar">
            <h2 class="section-title">Configure Session</h2>

            <!-- Quick Start Presets -->
            <div class="preset-buttons">
              <button type="button" class="btn-preset" data-preset="beginner">Beginner</button>
              <button type="button" class="btn-preset" data-preset="intermediate">Intermediate</button>
              <button type="button" class="btn-preset" data-preset="advanced">Advanced</button>
            </div>

            <div class="card setup-card">
              <div class="form-group">
                <div class="form-label-with-actions">
                  <label class="form-label">Multipliers</label>
                  <div class="multiplier-actions">
                    <button type="button" class="btn-link" id="select-all-multipliers">All</button>
                    <span class="action-divider">‚Ä¢</span>
                    <button type="button" class="btn-link" id="clear-all-multipliers">Clear</button>
                  </div>
                </div>
                <div class="checkbox-grid">
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="2">
                    <span>√ó2</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="3">
                    <span>√ó3</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="4">
                    <span>√ó4</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="5" checked>
                    <span>√ó5</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="6" checked>
                    <span>√ó6</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="7">
                    <span>√ó7</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="8">
                    <span>√ó8</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="9">
                    <span>√ó9</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="11" checked>
                    <span>√ó11</span>
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" name="multiplier" value="12" checked>
                    <span>√ó12</span>
                  </label>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label class="form-label" for="min-digits">Min Digits</label>
                  <input type="number" id="min-digits" class="input" min="2" max="6" value="3">
                </div>
                <div class="form-group">
                  <label class="form-label" for="max-digits">Max Digits</label>
                  <input type="number" id="max-digits" class="input" min="2" max="6" value="4">
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">Mode</label>
                <div class="radio-group-compact">
                  <label class="radio-item-compact" data-tooltip="Per-digit inputs with carry slots and hints">
                    <input type="radio" name="mode" value="easy" checked>
                    <span>Easy</span>
                  </label>
                  <label class="radio-item-compact" data-tooltip="Per-digit inputs without carry UI">
                    <input type="radio" name="mode" value="standard">
                    <span>Standard</span>
                  </label>
                  <label class="radio-item-compact" data-tooltip="Single input field, optional timer">
                    <input type="radio" name="mode" value="hard">
                    <span>Hard</span>
                  </label>
                  <label class="radio-item-compact" data-tooltip="Problem hidden after brief display">
                    <input type="radio" name="mode" value="extreme">
                    <span>Extreme</span>
                  </label>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label" for="problem-count">Problems</label>
                <input type="number" id="problem-count" class="input" min="5" max="100" value="10">
              </div>
            </div>
          </aside>

          <!-- Main Area (Right Side) -->
          <main class="setup-main">
            <div class="start-button-area">
              <button class="btn btn-primary btn-xl" id="start-session-btn">Start Practice</button>
              <p class="keyboard-hint">or press <kbd>Space</kbd></p>
            </div>
          </main>
        </div>
      </section>

      <!-- Practice Screen -->
      <section id="practice-screen" class="screen">
        <div class="practice-container">
          <div class="practice-header">
            <div class="progress-info">
              <span class="text-secondary">Problem <span id="current-problem">1</span> of <span id="total-problems">10</span></span>
              <span class="difficulty-badge" id="problem-difficulty"></span>
            </div>
            <button class="btn btn-outline btn-sm" id="end-session-btn">End Session</button>
          </div>

          <div class="problem-display">
            <div class="problem-operands font-mono" id="problem-operands">
              <!-- Will be populated by JS -->
            </div>

            <div class="problem-hint text-secondary text-sm" id="problem-hint">
              <!-- Hint text will appear here -->
            </div>

            <div id="answer-input-area">
              <!-- Answer input UI will be generated based on mode -->
            </div>

            <div class="problem-actions">
              <button class="btn btn-primary" id="submit-answer-btn">Submit Answer</button>
            </div>
          </div>

          <!-- Feedback Display -->
          <div id="feedback-display" class="feedback-display" style="display: none;">
            <div class="card">
              <div id="feedback-message" class="feedback-message">
                <!-- Feedback will be shown here -->
              </div>
              <div class="feedback-actions">
                <button class="btn btn-primary" id="next-problem-btn">Next Problem</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Session Complete Screen -->
      <section id="complete-screen" class="screen">
        <div class="complete-container">
          <h2 class="section-title">Session Complete!</h2>

          <div class="card stats-card">
            <div class="stats-grid">
              <div class="stat-item">
                <div class="stat-value" id="stat-accuracy">0%</div>
                <div class="stat-label">Accuracy</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="stat-correct">0</div>
                <div class="stat-label">Correct</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="stat-avg-time">0s</div>
                <div class="stat-label">Avg Time</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="stat-difficulty">-</div>
                <div class="stat-label">Difficulty</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="stat-records">0</div>
                <div class="stat-label">Records</div>
              </div>
            </div>

            <div class="complete-actions">
              <button class="btn btn-primary" id="new-session-btn">New Session</button>
              <button class="btn btn-secondary" id="same-config-btn">Same Settings</button>
              <button class="btn btn-outline" id="view-history-btn">View History</button>
            </div>
          </div>
        </div>
      </section>

      <!-- History Screen -->
      <section id="history-screen" class="screen">
        <div class="history-container">
          <div class="screen-header">
            <h2 class="section-title">Session History</h2>
            <button class="btn btn-outline btn-sm" id="back-to-setup-btn">Back</button>
          </div>

          <div id="history-list" class="history-list">
            <!-- History items will be populated by JS -->
          </div>
        </div>
      </section>

      <!-- About Screen -->
      <section id="about-screen" class="screen">
        <div class="about-container">
          <div class="screen-header">
            <h2 class="section-title">About TrachTrainer</h2>
            <button class="btn btn-outline btn-sm" id="about-back-btn">Back</button>
          </div>

          <div class="about-content">
            <div class="about-section">
              <h3 class="about-heading">The Trachtenberg Speed System</h3>
              <p>The Trachtenberg Speed System of Basic Mathematics is a revolutionary method for rapid mental calculation developed by Jakow Trachtenberg. This system allows you to multiply, divide, and perform other calculations with remarkable speed and accuracy using simple, specific rules for each operation.</p>
              <p>Each multiplier (5, 6, 7, 9, 11, 12) has its own unique pattern-based rule that eliminates the need for traditional multiplication tables. By learning these rules, you can perform complex calculations mentally that would normally require written work.</p>
            </div>

            <div class="about-section">
              <h3 class="about-heading">About Jakow Trachtenberg</h3>
              <p>Jakow Trachtenberg (1888-1953) was a Russian-born Jewish engineer who developed this system under extraordinary circumstances. During World War II, while imprisoned in a Nazi concentration camp, Trachtenberg created his speed calculation system to keep his mind active and maintain hope during his darkest hours.</p>
              <p>Despite the horrific conditions, he worked on perfecting his mathematical system, which he later taught to fellow prisoners to help them mentally escape their terrible reality. After the war, he escaped to Switzerland and dedicated his life to teaching his method, helping thousands of students discover their mathematical potential.</p>
              <p>His story is a testament to the resilience of the human spirit and the power of the mind to find light in the darkest places.</p>
            </div>

            <div class="about-section">
              <h3 class="about-heading">Learn More</h3>
              <p>To dive deeper into the Trachtenberg Speed System, we highly recommend reading the original book:</p>
              <p class="book-recommendation">
                <strong>"The Trachtenberg Speed System of Basic Mathematics"</strong><br>
                by Jakow Trachtenberg and Ann Cutler
              </p>
              <p>
                <a href="https://www.amazon.com/Trachtenberg-Speed-System-Basic-Mathematics/dp/0285629166"
                   target="_blank"
                   rel="noopener noreferrer"
                   class="btn btn-primary">
                  Buy the Book
                </a>
              </p>
            </div>

            <div class="about-section">
              <h3 class="about-heading">About This App</h3>
              <p>TrachTrainer is designed to be the "csTimer for Trachtenberg" - a minimal, focused practice tool to help you master the Trachtenberg Speed System through deliberate practice and repetition.</p>
              <p>This is an open-source project. Contributions and feedback are welcome!</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Progress Screen -->
      <section id="progress-screen" class="screen">
        <div class="progress-container">
          <div class="screen-header">
            <h2 class="section-title">Your Progress</h2>
            <button class="btn btn-outline btn-sm" id="progress-back-btn">Back</button>
          </div>

          <div class="progress-content">
            <!-- Tier Mastery Grid -->
            <div class="progress-section">
              <h3 class="progress-heading">Tier Mastery</h3>
              <div class="tier-grid" id="tier-grid">
                <!-- Generated by JS -->
              </div>
            </div>

            <!-- Multiplier Performance -->
            <div class="progress-section">
              <h3 class="progress-heading">Multiplier Performance</h3>
              <div class="multiplier-chart" id="multiplier-chart">
                <!-- Generated by JS -->
              </div>
            </div>

            <!-- Personal Records -->
            <div class="progress-section">
              <h3 class="progress-heading">Personal Records (Best Times)</h3>
              <div class="records-list" id="records-list">
                <!-- Generated by JS -->
              </div>
            </div>

            <!-- Milestones -->
            <div class="progress-section">
              <h3 class="progress-heading">Milestones</h3>
              <div class="milestones-grid" id="milestones-display">
                <!-- Generated by JS -->
              </div>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>

  <script src="utils.js"></script>
  <script src="rules.js"></script>
  <script src="app.js"></script>
</body>
</html>
